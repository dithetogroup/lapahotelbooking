import{a as Ie,b as we}from"./chunk-KV2HKO7R.js";import{C as _e,D as bt,F as Ce,L as G,a as Kt,b as Te,j as zt}from"./chunk-XJPX7IZZ.js";import{c as xe,d as Gt,g as yt,h as Tt,j as Wt}from"./chunk-27NP7QR4.js";import{Ac as S,B as he,Ba as mt,C as de,Cc as H,Da as z,E as fe,Eb as Ht,Fb as gt,Gb as Bt,H as J,Hb as be,Ia as P,J as pe,Ja as Ft,Kb as st,N as et,Na as Mt,Ob as Vt,Pa as it,Rb as vt,Sb as nt,Tb as g,Ub as rt,Wb as D,Y as A,Z as Rt,_c as Zt,aa as R,bc as C,cc as j,da as Z,dc as at,ec as $t,f as x,fc as Ut,g as L,ha as u,hc as Jt,ia as pt,jb as ge,jc as ye,ka as M,kb as Pt,ma as o,mc as ot,na as K,oc as b,p,q as U,qa as me,qb as f,r as O,t as tt,tb as ve,wb as v,x as Et,xa as Nt,y as At,ya as kt,z as ue}from"./chunk-YI4P4L32.js";import{a as m,b as $,e as Qe,g as qe}from"./chunk-QDSGMOWV.js";var Ne=Qe(It=>{"use strict";It.byteLength=ii;It.toByteArray=ni;It.fromByteArray=oi;var I=[],_=[],ei=typeof Uint8Array<"u"?Uint8Array:Array,ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(B=0,Ae=ie.length;B<Ae;++B)I[B]=ie[B],_[ie.charCodeAt(B)]=B;var B,Ae;_[45]=62;_[95]=63;function Re(i){var r=i.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=i.indexOf("=");t===-1&&(t=r);var e=t===r?0:4-t%4;return[t,e]}function ii(i){var r=Re(i),t=r[0],e=r[1];return(t+e)*3/4-e}function si(i,r,t){return(r+t)*3/4-t}function ni(i){var r,t=Re(i),e=t[0],s=t[1],n=new ei(si(i,e,s)),a=0,l=s>0?e-4:e,c;for(c=0;c<l;c+=4)r=_[i.charCodeAt(c)]<<18|_[i.charCodeAt(c+1)]<<12|_[i.charCodeAt(c+2)]<<6|_[i.charCodeAt(c+3)],n[a++]=r>>16&255,n[a++]=r>>8&255,n[a++]=r&255;return s===2&&(r=_[i.charCodeAt(c)]<<2|_[i.charCodeAt(c+1)]>>4,n[a++]=r&255),s===1&&(r=_[i.charCodeAt(c)]<<10|_[i.charCodeAt(c+1)]<<4|_[i.charCodeAt(c+2)]>>2,n[a++]=r>>8&255,n[a++]=r&255),n}function ri(i){return I[i>>18&63]+I[i>>12&63]+I[i>>6&63]+I[i&63]}function ai(i,r,t){for(var e,s=[],n=r;n<t;n+=3)e=(i[n]<<16&16711680)+(i[n+1]<<8&65280)+(i[n+2]&255),s.push(ri(e));return s.join("")}function oi(i){for(var r,t=i.length,e=t%3,s=[],n=16383,a=0,l=t-e;a<l;a+=n)s.push(ai(i,a,a+n>l?l:a+n));return e===1?(r=i[t-1],s.push(I[r>>2]+I[r<<4&63]+"==")):e===2&&(r=(i[t-2]<<8)+i[t-1],s.push(I[r>>10]+I[r>>4&63]+I[r<<2&63]+"=")),s.join("")}});var W=class{},Le=(()=>{class i extends W{getTranslation(t){return p({})}static \u0275fac=(()=>{let t;return function(s){return(t||(t=mt(i)))(s||i)}})();static \u0275prov=u({token:i,factory:i.\u0275fac})}return i})(),lt=class{},Oe=(()=>{class i{handle(t){return t.key}static \u0275fac=function(e){return new(e||i)};static \u0275prov=u({token:i,factory:i.\u0275fac})}return i})();function ct(i,r){if(i===r)return!0;if(i===null||r===null)return!1;if(i!==i&&r!==r)return!0;let t=typeof i,e=typeof r,s,n,a;if(t==e&&t=="object")if(Array.isArray(i)){if(!Array.isArray(r))return!1;if((s=i.length)==r.length){for(n=0;n<s;n++)if(!ct(i[n],r[n]))return!1;return!0}}else{if(Array.isArray(r))return!1;a=Object.create(null);for(n in i){if(!ct(i[n],r[n]))return!1;a[n]=!0}for(n in r)if(!(n in a)&&typeof r[n]<"u")return!1;return!0}return!1}function y(i){return typeof i<"u"&&i!==null}function Xt(i){return i&&typeof i=="object"&&!Array.isArray(i)}function Se(i,r){let t=Object.assign({},i);return Xt(i)&&Xt(r)&&Object.keys(r).forEach(e=>{Xt(r[e])?e in i?t[e]=Se(i[e],r[e]):Object.assign(t,{[e]:r[e]}):Object.assign(t,{[e]:r[e]})}),t}var X=class{},De=(()=>{class i extends X{templateMatcher=/{{\s?([^{}\s]*)\s?}}/g;interpolate(t,e){let s;return typeof t=="string"?s=this.interpolateString(t,e):typeof t=="function"?s=this.interpolateFunction(t,e):s=t,s}getValue(t,e){let s=typeof e=="string"?e.split("."):[e];e="";do e+=s.shift(),y(t)&&y(t[e])&&(typeof t[e]=="object"||!s.length)?(t=t[e],e=""):s.length?e+=".":t=void 0;while(s.length);return t}interpolateFunction(t,e){return t(e)}interpolateString(t,e){return e?t.replace(this.templateMatcher,(s,n)=>{let a=this.getValue(e,n);return y(a)?a:s}):t}static \u0275fac=(()=>{let t;return function(s){return(t||(t=mt(i)))(s||i)}})();static \u0275prov=u({token:i,factory:i.\u0275fac})}return i})(),Y=class{},je=(()=>{class i extends Y{compile(t,e){return t}compileTranslations(t,e){return t}static \u0275fac=(()=>{let t;return function(s){return(t||(t=mt(i)))(s||i)}})();static \u0275prov=u({token:i,factory:i.\u0275fac})}return i})(),_t=class{defaultLang;currentLang=this.defaultLang;translations={};langs=[];onTranslationChange=new P;onLangChange=new P;onDefaultLangChange=new P},Yt=new M("USE_STORE"),Qt=new M("USE_DEFAULT_LANG"),qt=new M("DEFAULT_LANGUAGE"),te=new M("USE_EXTEND"),Q=(()=>{class i{store;currentLoader;compiler;parser;missingTranslationHandler;useDefaultLang;isolate;extend;loadingTranslations;pending=!1;_onTranslationChange=new P;_onLangChange=new P;_onDefaultLangChange=new P;_defaultLang;_currentLang;_langs=[];_translations={};_translationRequests={};get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(t){this.isolate?this._defaultLang=t:this.store.defaultLang=t}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(t){this.isolate?this._currentLang=t:this.store.currentLang=t}get langs(){return this.isolate?this._langs:this.store.langs}set langs(t){this.isolate?this._langs=t:this.store.langs=t}get translations(){return this.isolate?this._translations:this.store.translations}set translations(t){this.isolate?this._translations=t:this.store.translations=t}constructor(t,e,s,n,a,l=!0,c=!1,d=!1,h){this.store=t,this.currentLoader=e,this.compiler=s,this.parser=n,this.missingTranslationHandler=a,this.useDefaultLang=l,this.isolate=c,this.extend=d,h&&this.setDefaultLang(h)}setDefaultLang(t){if(t===this.defaultLang)return;let e=this.retrieveTranslations(t);typeof e<"u"?(this.defaultLang==null&&(this.defaultLang=t),e.pipe(et(1)).subscribe(s=>{this.changeDefaultLang(t)})):this.changeDefaultLang(t)}getDefaultLang(){return this.defaultLang}use(t){if(t===this.currentLang)return p(this.translations[t]);let e=this.retrieveTranslations(t);return typeof e<"u"?(this.currentLang||(this.currentLang=t),e.pipe(et(1)).subscribe(s=>{this.changeLang(t)}),e):(this.changeLang(t),p(this.translations[t]))}retrieveTranslations(t){let e;return(typeof this.translations[t]>"u"||this.extend)&&(this._translationRequests[t]=this._translationRequests[t]||this.getTranslation(t),e=this._translationRequests[t]),e}getTranslation(t){this.pending=!0;let e=this.currentLoader.getTranslation(t).pipe(Rt(1),et(1));return this.loadingTranslations=e.pipe(tt(s=>this.compiler.compileTranslations(s,t)),Rt(1),et(1)),this.loadingTranslations.subscribe({next:s=>{this.translations[t]=this.extend&&this.translations[t]?m(m({},s),this.translations[t]):s,this.updateLangs(),this.pending=!1},error:s=>{this.pending=!1}}),e}setTranslation(t,e,s=!1){e=this.compiler.compileTranslations(e,t),(s||this.extend)&&this.translations[t]?this.translations[t]=Se(this.translations[t],e):this.translations[t]=e,this.updateLangs(),this.onTranslationChange.emit({lang:t,translations:this.translations[t]})}getLangs(){return this.langs}addLangs(t){t.forEach(e=>{this.langs.indexOf(e)===-1&&this.langs.push(e)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(t,e,s){let n;if(e instanceof Array){let a={},l=!1;for(let c of e)a[c]=this.getParsedResult(t,c,s),O(a[c])&&(l=!0);if(l){let c=e.map(d=>O(a[d])?a[d]:p(a[d]));return ue(c).pipe(tt(d=>{let h={};return d.forEach((w,E)=>{h[e[E]]=w}),h}))}return a}if(t&&(n=this.parser.interpolate(this.parser.getValue(t,e),s)),typeof n>"u"&&this.defaultLang!=null&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(n=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],e),s)),typeof n>"u"){let a={key:e,translateService:this};typeof s<"u"&&(a.interpolateParams=s),n=this.missingTranslationHandler.handle(a)}return typeof n<"u"?n:e}get(t,e){if(!y(t)||!t.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe(pe(s=>(s=this.getParsedResult(s,t,e),O(s)?s:p(s))));{let s=this.getParsedResult(this.translations[this.currentLang],t,e);return O(s)?s:p(s)}}getStreamOnTranslationChange(t,e){if(!y(t)||!t.length)throw new Error('Parameter "key" required');return Et(At(()=>this.get(t,e)),this.onTranslationChange.pipe(R(s=>{let n=this.getParsedResult(s.translations,t,e);return typeof n.subscribe=="function"?n:p(n)})))}stream(t,e){if(!y(t)||!t.length)throw new Error('Parameter "key" required');return Et(At(()=>this.get(t,e)),this.onLangChange.pipe(R(s=>{let n=this.getParsedResult(s.translations,t,e);return O(n)?n:p(n)})))}instant(t,e){if(!y(t)||!t.length)throw new Error('Parameter "key" required');let s=this.getParsedResult(this.translations[this.currentLang],t,e);if(O(s)){if(t instanceof Array){let n={};return t.forEach((a,l)=>{n[t[l]]=t[l]}),n}return t}else return s}set(t,e,s=this.currentLang){this.translations[s][t]=this.compiler.compile(e,s),this.updateLangs(),this.onTranslationChange.emit({lang:s,translations:this.translations[s]})}changeLang(t){this.currentLang=t,this.onLangChange.emit({lang:t,translations:this.translations[t]}),this.defaultLang==null&&this.changeDefaultLang(t)}changeDefaultLang(t){this.defaultLang=t,this.onDefaultLangChange.emit({lang:t,translations:this.translations[t]})}reloadLang(t){return this.resetLang(t),this.getTranslation(t)}resetLang(t){this._translationRequests[t]=void 0,this.translations[t]=void 0}getBrowserLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let t=window.navigator.languages?window.navigator.languages[0]:null;if(t=t||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,!(typeof t>"u"))return t.indexOf("-")!==-1&&(t=t.split("-")[0]),t.indexOf("_")!==-1&&(t=t.split("_")[0]),t}getBrowserCultureLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let t=window.navigator.languages?window.navigator.languages[0]:null;return t=t||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,t}static \u0275fac=function(e){return new(e||i)(o(_t),o(W),o(Y),o(X),o(lt),o(Qt),o(Yt),o(te),o(qt))};static \u0275prov=u({token:i,factory:i.\u0275fac})}return i})(),Ki=(()=>{class i{translateService;element;_ref;key;lastParams;currentParams;onLangChangeSub;onDefaultLangChangeSub;onTranslationChangeSub;set translate(t){t&&(this.key=t,this.checkNodes())}set translateParams(t){ct(this.currentParams,t)||(this.currentParams=t,this.checkNodes(!0))}constructor(t,e,s){this.translateService=t,this.element=e,this._ref=s,this.onTranslationChangeSub||(this.onTranslationChangeSub=this.translateService.onTranslationChange.subscribe(n=>{n.lang===this.translateService.currentLang&&this.checkNodes(!0,n.translations)})),this.onLangChangeSub||(this.onLangChangeSub=this.translateService.onLangChange.subscribe(n=>{this.checkNodes(!0,n.translations)})),this.onDefaultLangChangeSub||(this.onDefaultLangChangeSub=this.translateService.onDefaultLangChange.subscribe(n=>{this.checkNodes(!0)}))}ngAfterViewChecked(){this.checkNodes()}checkNodes(t=!1,e){let s=this.element.nativeElement.childNodes;s.length||(this.setContent(this.element.nativeElement,this.key),s=this.element.nativeElement.childNodes);for(let n=0;n<s.length;++n){let a=s[n];if(a.nodeType===3){let l;if(t&&(a.lastKey=null),y(a.lookupKey))l=a.lookupKey;else if(this.key)l=this.key;else{let c=this.getContent(a),d=c.trim();d.length&&(a.lookupKey=d,c!==a.currentValue?(l=d,a.originalContent=c||a.originalContent):a.originalContent?l=a.originalContent.trim():c!==a.currentValue&&(l=d,a.originalContent=c||a.originalContent))}this.updateValue(l,a,e)}}}updateValue(t,e,s){if(t){if(e.lastKey===t&&this.lastParams===this.currentParams)return;this.lastParams=this.currentParams;let n=a=>{a!==t&&(e.lastKey=t),e.originalContent||(e.originalContent=this.getContent(e)),e.currentValue=y(a)?a:e.originalContent||t,this.setContent(e,this.key?e.currentValue:e.originalContent.replace(t,e.currentValue)),this._ref.markForCheck()};if(y(s)){let a=this.translateService.getParsedResult(s,t,this.currentParams);O(a)?a.subscribe({next:n}):n(a)}else this.translateService.get(t,this.currentParams).subscribe(n)}}getContent(t){return y(t.textContent)?t.textContent:t.data}setContent(t,e){y(t.textContent)?t.textContent=e:t.data=e}ngOnDestroy(){this.onLangChangeSub&&this.onLangChangeSub.unsubscribe(),this.onDefaultLangChangeSub&&this.onDefaultLangChangeSub.unsubscribe(),this.onTranslationChangeSub&&this.onTranslationChangeSub.unsubscribe()}static \u0275fac=function(e){return new(e||i)(v(Q),v(Mt),v(Zt))};static \u0275dir=Bt({type:i,selectors:[["","translate",""],["","ngx-translate",""]],inputs:{translate:"translate",translateParams:"translateParams"},standalone:!1})}return i})(),zi=(()=>{class i{translate;_ref;value="";lastKey=null;lastParams=[];onTranslationChange;onLangChange;onDefaultLangChange;constructor(t,e){this.translate=t,this._ref=e}updateValue(t,e,s){let n=a=>{this.value=a!==void 0?a:t,this.lastKey=t,this._ref.markForCheck()};if(s){let a=this.translate.getParsedResult(s,t,e);O(a.subscribe)?a.subscribe(n):n(a)}this.translate.get(t,e).subscribe(n)}transform(t,...e){if(!t||!t.length)return t;if(ct(t,this.lastKey)&&ct(e,this.lastParams))return this.value;let s;if(y(e[0])&&e.length)if(typeof e[0]=="string"&&e[0].length){let n=e[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{s=JSON.parse(n)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${e[0]}`)}}else typeof e[0]=="object"&&!Array.isArray(e[0])&&(s=e[0]);return this.lastKey=t,this.lastParams=e,this.updateValue(t,s),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(n=>{this.lastKey&&n.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(t,s,n.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(n=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,s,n.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,s))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}static \u0275fac=function(e){return new(e||i)(v(Q,16),v(Zt,16))};static \u0275pipe=be({name:"translate",type:i,pure:!1,standalone:!1});static \u0275prov=u({token:i,factory:i.\u0275fac})}return i})(),Gi=(()=>{class i{static forRoot(t={}){return{ngModule:i,providers:[t.loader||{provide:W,useClass:Le},t.compiler||{provide:Y,useClass:je},t.parser||{provide:X,useClass:De},t.missingTranslationHandler||{provide:lt,useClass:Oe},_t,{provide:Yt,useValue:t.isolate},{provide:Qt,useValue:t.useDefaultLang},{provide:te,useValue:t.extend},{provide:qt,useValue:t.defaultLanguage},Q]}}static forChild(t={}){return{ngModule:i,providers:[t.loader||{provide:W,useClass:Le},t.compiler||{provide:Y,useClass:je},t.parser||{provide:X,useClass:De},t.missingTranslationHandler||{provide:lt,useClass:Oe},{provide:Yt,useValue:t.isolate},{provide:Qt,useValue:t.useDefaultLang},{provide:te,useValue:t.extend},{provide:qt,useValue:t.defaultLanguage},Q]}}static \u0275fac=function(e){return new(e||i)};static \u0275mod=gt({type:i});static \u0275inj=pt({})}return i})();var N=(()=>{class i{get(t){return JSON.parse(localStorage.getItem(t)||"{}")||{}}set(t,e){return localStorage.setItem(t,JSON.stringify(e)),!0}has(t){return!!localStorage.getItem(t)}remove(t){localStorage.removeItem(t)}clear(){localStorage.clear()}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ee={navPos:"top",dir:"ltr",theme:"light",color:"orange",showHeader:!0,headerPos:"fixed",showFooter:!0,footerPos:"static",showUserPanel:!0,sidenavOpened:!0,sidenavCollapsed:!1,language:"en-US"};var xt=(()=>{class i{get notify(){return this.notify$.asObservable()}constructor(t){this.store=t,this.key="redstar-settings",this.notify$=new L({});let e=this.store.get(this.key);this.options=Object.assign(ee,e)}getOptions(){return this.options}setOptions(t){this.options=Object.assign(ee,t),this.store.set(this.key,this.options),this.notify$.next(this.options)}getLanguage(){return this.options.language}setLanguage(t){this.options.language=t,this.store.set(this.key,this.options),this.notify$.next(this.options)}reset(){this.store.remove(this.key)}static{this.\u0275fac=function(e){return new(e||i)(o(N))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Lt=qe(Ne()),wt=class{static encode(r){return(0,Lt.fromByteArray)(li(r)).replace(/[+/=]/g,t=>({"+":"-","/":"_","=":""})[t])}static decode(r){for(r=r.replace(/[-_]/g,t=>({"-":"+",_:"/"})[t]);r.length%4;)r+="=";return ci((0,Lt.toByteArray)(r))}};function li(i){let r=[];for(let t=0;t<i.length;t++)r.push(i.charCodeAt(t));return r}function ci(i){return String.fromCharCode(...i)}var k={encode:wt.encode,decode:wt.decode};function ke(i){return i.substring(0,1).toUpperCase()+i.substring(1,i.length).toLowerCase()}function V(){return Math.ceil(new Date().getTime()/1e3)}function Fe(i){return Math.max(0,i-V())}function ut(i){return Object.fromEntries(Object.entries(i).filter(([,r])=>r!=null))}var se=class{constructor(r){this.attributes=r}get access_token(){return this.attributes.access_token}get refresh_token(){return this.attributes.refresh_token}get token_type(){return this.attributes.token_type??"bearer"}get exp(){return this.attributes.exp}valid(){return this.hasAccessToken()&&!this.isExpired()}getBearerToken(){return this.access_token?[ke(this.token_type),this.access_token].join(" ").trim():""}needRefresh(){return this.exp!==void 0&&this.exp>=0}getRefreshTime(){return Fe((this.exp??0)-5)}hasAccessToken(){return!!this.access_token}isExpired(){return this.exp!==void 0&&this.exp-V()<=0}},ht=class extends se{},dt=class extends ht{static is(r){try{let[t]=r.split(".");return JSON.parse(k.decode(t)).typ.toUpperCase().includes("JWT")}catch{return!1}}get exp(){return this.payload?.exp}get payload(){if(!this.access_token)return{};if(this._payload)return this._payload;let[,r]=this.access_token.split("."),t=JSON.parse(k.decode(r));return t.exp||(t.exp=this.attributes.exp),this._payload=t}};var Me=(()=>{class i{create(t){if(t.access_token)return dt.is(t.access_token)?new dt(t):new ht(t)}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Ot=(()=>{class i{constructor(t,e){this.store=t,this.factory=e,this.key="redstar-token",this.change$=new L(void 0),this.refresh$=new x,this._roleArray=[],this._permissionArray=[]}get token(){return this._token||(this._token=this.factory.create(this.store.get(this.key))),this._token}change(){return this.change$.pipe(A())}refresh(){return this.buildRefresh(),this.refresh$.pipe(A())}set(t){return this.save(t),this}clear(){this.save()}valid(){return this.token?.valid()??!1}getBearerToken(){return this.token?.getBearerToken()??""}getRefreshToken(){return this.token?.refresh_token}ngOnDestroy(){this.clearRefresh()}save(t){if(this._token=void 0,!t)this.store.remove(this.key);else{let e=Object.assign({access_token:"",token_type:"Bearer"},t,{exp:t.expires_in?V()+t.expires_in:null});this.store.set(this.key,ut(e))}this.change$.next(this.token),this.buildRefresh()}buildRefresh(){this.clearRefresh(),this.token?.needRefresh()&&(this.timer$=de(this.token.getRefreshTime()*1e3).subscribe(()=>{this.refresh$.next(this.token)}))}clearRefresh(){this.timer$&&!this.timer$.closed&&this.timer$.unsubscribe()}get roleArray(){return this._roleArray}set roleArray(t){this._roleArray=t}get permissionArray(){return this._permissionArray}set permissionArray(t){this._permissionArray=t}static{this.\u0275fac=function(e){return new(e||i)(o(N),o(Me))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Pe=(()=>{class i{constructor(t,e,s){this.injector=t,this.translate=e,this.settings=s}load(){return new Promise(t=>{this.injector.get(Te,Promise.resolve()).then(()=>{let s=navigator.language,n=s.match(/en-US|de-DE|es-ES/)?s:"en-US";this.settings.setLanguage(n),this.translate.setDefaultLang(n),this.translate.use(n).subscribe(()=>console.log(`Successfully initialized '${n}' language.'`),()=>console.error(`Problem with '${n}' language initialization.'`),()=>t())})})}static{this.\u0275fac=function(e){return new(e||i)(o(z),o(Q),o(xt))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var He=(()=>{class i{constructor(){this.menu$=new L([])}getAll(){return this.menu$.asObservable()}change(){return this.menu$.pipe(A())}set(t){return this.menu$.next(t),this.menu$.asObservable()}add(t){let e=this.menu$.value;e.push(t),this.menu$.next(e)}reset(){this.menu$.next([])}buildRoute(t){let e="";return t.forEach(s=>{s&&s.trim()&&(e+="/"+s.replace(/^\/+|\/+$/g,""))}),e}getItemName(t){return this.getLevel(t)[t.length-1]}isLeafItem(t){let e=t.route===void 0,s=t.children===void 0,n=!s&&t.children?.length===0;return e||s||n}deepClone(t){return JSON.parse(JSON.stringify(t))}isJsonObjEqual(t,e){return JSON.stringify(t)===JSON.stringify(e)}isRouteEqual(t,e){return e=this.deepClone(e),e=e.filter(s=>s!==""),this.isJsonObjEqual(t,e)}getLevel(t){let e=[];return this.menu$.value.forEach(s=>{let n=[{item:s,parentNamePathList:[],realRouteArr:[]}];for(;n.length>0;){let a=[];for(let l of n){let c=l.item,d=this.deepClone(l.parentNamePathList).concat(c.name),h=this.deepClone(l.realRouteArr).concat(c.route);if(this.isRouteEqual(t,h)){e=d;break}if(!this.isLeafItem(c)){let w=c.children?.map(E=>({item:E,parentNamePathList:d,realRouteArr:h}));a=a.concat(w)}}n=a}}),e}addNamespace(t,e){t.forEach(s=>{s.name=`${e}.${s.name}`,s.children&&s.children.length>0&&this.addNamespace(s.children,s.name)})}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Ve=(()=>{class i{constructor(t,e,s,n){this.authService=t,this.rolesService=e,this.permissonsService=s,this.menuService=n}load(){return this.authService.change().pipe(Z(t=>this.setPermissions(t)),R(()=>this.authService.menu()),Z(t=>{this.setMenu(t)})).subscribe()}setMenu(t){this.menuService.addNamespace(t,"menu"),this.menuService.set(t)}setPermissions(t){let e={};t.role?.forEach(s=>{this.permissonsService.loadPermissions(t.permissions),this.rolesService.flushRoles();let n=s.name;e[n]=t.permissions}),this.rolesService.addRolesWithPermissions(e)}static{this.\u0275fac=function(e){return new(e||i)(o(Be),o(we),o(Ie),o(He))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function pi(i){return()=>i.load()}function mi(i){return()=>i.load()}var Ls=[{provide:Vt,useFactory:pi,deps:[Pe],multi:!0},{provide:Vt,useFactory:mi,deps:[Ve],multi:!0}];var $e=(()=>{class i{constructor(t){this.settings=t}intercept(t,e){return e.handle(t.clone({headers:t.headers.append("Accept-Language",this.settings.getLanguage())}))}static{this.\u0275fac=function(e){return new(e||i)(o(xt))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac})}}return i})();var Je=(()=>{class i{constructor(t,e){this.tokenService=t,this.router=e,this.hasHttpScheme=s=>new RegExp("^http(s)?://","i").test(s)}intercept(t,e){let s=()=>{t.url.includes("/auth/logout")&&this.router.navigateByUrl("/auth/login")};return this.tokenService.valid()&&this.shouldAppendToken(t.url)?e.handle(t.clone({headers:t.headers.append("Authorization",this.tokenService.getBearerToken()),withCredentials:!0})).pipe(J(n=>(n.status===401&&this.tokenService.clear(),U(n))),Z(()=>s())):e.handle(t).pipe(Z(()=>s()))}shouldAppendToken(t){return!this.hasHttpScheme(t)}static{this.\u0275fac=function(e){return new(e||i)(o(Ot),o(G))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac})}}return i})();var Ze=["toast-component",""];function vi(i,r){if(i&1){let t=Jt();C(0,"button",5),ot("click",function(){Nt(t);let s=b();return kt(s.remove())}),C(1,"span",6),S(2,"\xD7"),j()()}}function bi(i,r){if(i&1&&($t(0),S(1),Ut()),i&2){let t=b(2);f(),H("[",t.duplicatesCount+1,"]")}}function yi(i,r){if(i&1&&(C(0,"div"),S(1),st(2,bi,2,1,"ng-container",4),j()),i&2){let t=b();D(t.options.titleClass),nt("aria-label",t.title),f(),H(" ",t.title," "),f(),g("ngIf",t.duplicatesCount)}}function Ti(i,r){if(i&1&&at(0,"div",7),i&2){let t=b();D(t.options.messageClass),g("innerHTML",t.message,Pt)}}function _i(i,r){if(i&1&&(C(0,"div",8),S(1),j()),i&2){let t=b();D(t.options.messageClass),nt("aria-label",t.message),f(),H(" ",t.message," ")}}function Ci(i,r){if(i&1&&(C(0,"div"),at(1,"div",9),j()),i&2){let t=b();f(),rt("width",t.width()+"%")}}function xi(i,r){if(i&1){let t=Jt();C(0,"button",5),ot("click",function(){Nt(t);let s=b();return kt(s.remove())}),C(1,"span",6),S(2,"\xD7"),j()()}}function Ii(i,r){if(i&1&&($t(0),S(1),Ut()),i&2){let t=b(2);f(),H("[",t.duplicatesCount+1,"]")}}function wi(i,r){if(i&1&&(C(0,"div"),S(1),st(2,Ii,2,1,"ng-container",4),j()),i&2){let t=b();D(t.options.titleClass),nt("aria-label",t.title),f(),H(" ",t.title," "),f(),g("ngIf",t.duplicatesCount)}}function Li(i,r){if(i&1&&at(0,"div",7),i&2){let t=b();D(t.options.messageClass),g("innerHTML",t.message,Pt)}}function Oi(i,r){if(i&1&&(C(0,"div",8),S(1),j()),i&2){let t=b();D(t.options.messageClass),nt("aria-label",t.message),f(),H(" ",t.message," ")}}function Di(i,r){if(i&1&&(C(0,"div"),at(1,"div",9),j()),i&2){let t=b();f(),rt("width",t.width()+"%")}}var ne=class{_attachedHost;component;viewContainerRef;injector;constructor(r,t){this.component=r,this.injector=t}attach(r,t){return this._attachedHost=r,r.attach(this,t)}detach(){let r=this._attachedHost;if(r)return this._attachedHost=void 0,r.detach()}get isAttached(){return this._attachedHost!=null}setAttachedHost(r){this._attachedHost=r}},re=class{_attachedPortal;_disposeFn;attach(r,t){return this._attachedPortal=r,this.attachComponentPortal(r,t)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(r){this._disposeFn=r}},ae=class{_overlayRef;componentInstance;duplicatesCount=0;_afterClosed=new x;_activate=new x;_manualClose=new x;_resetTimeout=new x;_countDuplicate=new x;constructor(r){this._overlayRef=r}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(r,t){r&&this._resetTimeout.next(),t&&this._countDuplicate.next(++this.duplicatesCount)}},q=class{toastId;config;message;title;toastType;toastRef;_onTap=new x;_onAction=new x;constructor(r,t,e,s,n,a){this.toastId=r,this.config=t,this.message=e,this.title=s,this.toastType=n,this.toastRef=a,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(r){this._onAction.next(r)}onAction(){return this._onAction.asObservable()}},Ke={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing"},ze=new M("ToastConfig"),oe=class extends re{_hostDomElement;_componentFactoryResolver;_appRef;constructor(r,t,e){super(),this._hostDomElement=r,this._componentFactoryResolver=t,this._appRef=e}attachComponentPortal(r,t){let e=this._componentFactoryResolver.resolveComponentFactory(r.component),s;return s=e.create(r.injector),this._appRef.attachView(s.hostView),this.setDisposeFn(()=>{this._appRef.detachView(s.hostView),s.destroy()}),t?this._hostDomElement.insertBefore(this._getComponentRootNode(s),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(s)),s}_getComponentRootNode(r){return r.hostView.rootNodes[0]}},ji=(()=>{class i{_document=K(Kt);_containerElement;ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let t=this._document.createElement("div");t.classList.add("overlay-container"),t.setAttribute("aria-live","polite"),this._document.body.appendChild(t),this._containerElement=t}static \u0275fac=function(e){return new(e||i)};static \u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),le=class{_portalHost;constructor(r){this._portalHost=r}attach(r,t=!0){return this._portalHost.attach(r,t)}detach(){return this._portalHost.detach()}},Si=(()=>{class i{_overlayContainer=K(ji);_componentFactoryResolver=K(ve);_appRef=K(vt);_document=K(Kt);_paneElements=new Map;create(t,e){return this._createOverlayRef(this.getPaneElement(t,e))}getPaneElement(t="",e){return this._paneElements.get(e)||this._paneElements.set(e,{}),this._paneElements.get(e)[t]||(this._paneElements.get(e)[t]=this._createPaneElement(t,e)),this._paneElements.get(e)[t]}_createPaneElement(t,e){let s=this._document.createElement("div");return s.id="toast-container",s.classList.add(t),s.classList.add("toast-container"),e?e.getContainerElement().appendChild(s):this._overlayContainer.getContainerElement().appendChild(s),s}_createPortalHost(t){return new oe(t,this._componentFactoryResolver,this._appRef)}_createOverlayRef(t){return new le(this._createPortalHost(t))}static \u0275fac=function(e){return new(e||i)};static \u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Dt=(()=>{class i{overlay;_injector;sanitizer;ngZone;toastrConfig;currentlyActive=0;toasts=[];overlayContainer;previousToastMessage;index=0;constructor(t,e,s,n,a){this.overlay=e,this._injector=s,this.sanitizer=n,this.ngZone=a,this.toastrConfig=m(m({},t.default),t.config),t.config.iconClasses&&(this.toastrConfig.iconClasses=m(m({},t.default.iconClasses),t.config.iconClasses))}show(t,e,s={},n=""){return this._preBuildNotification(n,t,e,this.applyConfig(s))}success(t,e,s={}){let n=this.toastrConfig.iconClasses.success||"";return this._preBuildNotification(n,t,e,this.applyConfig(s))}error(t,e,s={}){let n=this.toastrConfig.iconClasses.error||"";return this._preBuildNotification(n,t,e,this.applyConfig(s))}info(t,e,s={}){let n=this.toastrConfig.iconClasses.info||"";return this._preBuildNotification(n,t,e,this.applyConfig(s))}warning(t,e,s={}){let n=this.toastrConfig.iconClasses.warning||"";return this._preBuildNotification(n,t,e,this.applyConfig(s))}clear(t){for(let e of this.toasts)if(t!==void 0){if(e.toastId===t){e.toastRef.manualClose();return}}else e.toastRef.manualClose()}remove(t){let e=this._findToast(t);if(!e||(e.activeToast.toastRef.close(),this.toasts.splice(e.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){let s=this.toasts[this.currentlyActive].toastRef;s.isInactive()||(this.currentlyActive=this.currentlyActive+1,s.activate())}return!0}findDuplicate(t="",e="",s,n){let{includeTitleDuplicates:a}=this.toastrConfig;for(let l of this.toasts){let c=a&&l.title===t;if((!a||c)&&l.message===e)return l.toastRef.onDuplicate(s,n),l}return null}applyConfig(t={}){return m(m({},this.toastrConfig),t)}_findToast(t){for(let e=0;e<this.toasts.length;e++)if(this.toasts[e].toastId===t)return{index:e,activeToast:this.toasts[e]};return null}_preBuildNotification(t,e,s,n){return n.onActivateTick?this.ngZone.run(()=>this._buildNotification(t,e,s,n)):this._buildNotification(t,e,s,n)}_buildNotification(t,e,s,n){if(!n.toastComponent)throw new Error("toastComponent required");let a=this.findDuplicate(s,e,this.toastrConfig.resetTimeoutOnDuplicate&&n.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&s||e)&&this.toastrConfig.preventDuplicates&&a!==null)return a;this.previousToastMessage=e;let l=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(l=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));let c=this.overlay.create(n.positionClass,this.overlayContainer);this.index=this.index+1;let d=e;e&&n.enableHtml&&(d=this.sanitizer.sanitize(ge.HTML,e));let h=new ae(c),w=new q(this.index,n,d,s,t,h),E=[{provide:q,useValue:w}],ft=z.create({providers:E,parent:this._injector}),Ye=new ne(n.toastComponent,ft),ce=c.attach(Ye,n.newestOnTop);h.componentInstance=ce.instance;let St={toastId:this.index,title:s||"",message:e||"",toastRef:h,onShown:h.afterActivate(),onHidden:h.afterClosed(),onTap:w.onTap(),onAction:w.onAction(),portal:ce};return l||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{St.toastRef.activate()})),this.toasts.push(St),St}static \u0275fac=function(e){return new(e||i)(o(ze),o(Si),o(z),o(Ce),o(Ft))};static \u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Ei=(()=>{class i{toastrService;toastPackage;ngZone;message;title;options;duplicatesCount;originalTimeout;width=it(-1);toastClasses="";state;get _state(){return this.state()}get displayStyle(){if(this.state().value==="inactive")return"none"}timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(t,e,s){this.toastrService=t,this.toastPackage=e,this.ngZone=s,this.message=e.message,this.title=e.title,this.options=e.config,this.originalTimeout=e.config.timeOut,this.toastClasses=`${e.toastType} ${e.config.toastClass}`,this.sub=e.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=e.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=e.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=e.toastRef.countDuplicate().subscribe(n=>{this.duplicatesCount=n}),this.state=it({value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.update(t=>$(m({},t),{value:"active"})),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let t=new Date().getTime(),e=this.hideTime-t;this.width.set(e/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(s=>100-s),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.update(t=>$(m({},t),{value:"active"})),this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){this.state().value!=="removed"&&(clearTimeout(this.timeout),this.state.update(t=>$(m({},t),{value:"removed"})),this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){this.state().value!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state().value!=="removed"&&this.options.disableTimeOut!=="extendedTimeOut"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state().value==="removed"||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(t,e){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(t),e)):this.timeout=setTimeout(()=>t(),e)}outsideInterval(t,e){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(t),e)):this.intervalId=setInterval(()=>t(),e)}runInsideAngular(t){this.ngZone?this.ngZone.run(()=>t()):t()}static \u0275fac=function(e){return new(e||i)(v(Dt),v(q),v(Ft))};static \u0275cmp=Ht({type:i,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(e,s){e&1&&ot("click",function(){return s.tapToast()})("mouseenter",function(){return s.stickAround()})("mouseleave",function(){return s.delayedHideToast()}),e&2&&(ye("@flyInOut",s._state),D(s.toastClasses),rt("display",s.displayStyle))},attrs:Ze,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(e,s){e&1&&st(0,vi,3,0,"button",0)(1,yi,3,5,"div",1)(2,Ti,1,3,"div",2)(3,_i,2,4,"div",3)(4,Ci,2,2,"div",4),e&2&&(g("ngIf",s.options.closeButton),f(),g("ngIf",s.title),f(),g("ngIf",s.message&&s.options.enableHtml),f(),g("ngIf",s.message&&!s.options.enableHtml),f(),g("ngIf",s.options.progressBar))},dependencies:[zt],encapsulation:2,data:{animation:[xe("flyInOut",[Tt("inactive",yt({opacity:0})),Tt("active",yt({opacity:1})),Tt("removed",yt({opacity:0})),Wt("inactive => active",Gt("{{ easeTime }}ms {{ easing }}")),Wt("active => removed",Gt("{{ easeTime }}ms {{ easing }}"))])]},changeDetection:0})}return i})(),Ai=$(m({},Ke),{toastComponent:Ei}),Ri=(i={})=>me([{provide:ze,useValue:{default:Ai,config:i}}]),Zs=(()=>{class i{static forRoot(t={}){return{ngModule:i,providers:[Ri(t)]}}static \u0275fac=function(e){return new(e||i)};static \u0275mod=gt({type:i});static \u0275inj=pt({})}return i})();var Ni=(()=>{class i{toastrService;toastPackage;appRef;message;title;options;duplicatesCount;originalTimeout;width=it(-1);toastClasses="";get displayStyle(){return this.state()==="inactive"?"none":null}state=it("inactive");timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(t,e,s){this.toastrService=t,this.toastPackage=e,this.appRef=s,this.message=e.message,this.title=e.title,this.options=e.config,this.originalTimeout=e.config.timeOut,this.toastClasses=`${e.toastType} ${e.config.toastClass}`,this.sub=e.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=e.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=e.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=e.toastRef.countDuplicate().subscribe(n=>{this.duplicatesCount=n})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.set("active"),!(this.options.disableTimeOut===!0||this.options.disableTimeOut==="timeOut")&&this.options.timeOut&&(this.timeout=setTimeout(()=>{this.remove()},this.options.timeOut),this.hideTime=new Date().getTime()+this.options.timeOut,this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))),this.options.onActivateTick&&this.appRef.tick()}updateProgress(){if(this.width()===0||this.width()===100||!this.options.timeOut)return;let t=new Date().getTime(),e=this.hideTime-t;this.width.set(e/this.options.timeOut*100),this.options.progressAnimation==="increasing"&&this.width.update(s=>100-s),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.set("active"),this.options.timeOut=this.originalTimeout,this.timeout=setTimeout(()=>this.remove(),this.originalTimeout),this.hideTime=new Date().getTime()+(this.originalTimeout||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10))}remove(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.state.set("removed"),this.timeout=setTimeout(()=>this.toastrService.remove(this.toastPackage.toastId)))}tapToast(){this.state()!=="removed"&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){this.state()!=="removed"&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){this.options.disableTimeOut===!0||this.options.disableTimeOut==="extendedTimeOut"||this.options.extendedTimeOut===0||this.state()==="removed"||(this.timeout=setTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=new Date().getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&(this.intervalId=setInterval(()=>this.updateProgress(),10)))}static \u0275fac=function(e){return new(e||i)(v(Dt),v(q),v(vt))};static \u0275cmp=Ht({type:i,selectors:[["","toast-component",""]],hostVars:4,hostBindings:function(e,s){e&1&&ot("click",function(){return s.tapToast()})("mouseenter",function(){return s.stickAround()})("mouseleave",function(){return s.delayedHideToast()}),e&2&&(D(s.toastClasses),rt("display",s.displayStyle))},attrs:Ze,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(e,s){e&1&&st(0,xi,3,0,"button",0)(1,wi,3,5,"div",1)(2,Li,1,3,"div",2)(3,Oi,2,4,"div",3)(4,Di,2,2,"div",4),e&2&&(g("ngIf",s.options.closeButton),f(),g("ngIf",s.title),f(),g("ngIf",s.message&&s.options.enableHtml),f(),g("ngIf",s.message&&!s.options.enableHtml),f(),g("ngIf",s.options.progressBar))},dependencies:[zt],encapsulation:2,changeDetection:0})}return i})(),Ks=$(m({},Ke),{toastComponent:Ni});var F=function(i){return i[i.UNAUTHORIZED=401]="UNAUTHORIZED",i[i.FORBIDDEN=403]="FORBIDDEN",i[i.NOT_FOUND=404]="NOT_FOUND",i[i.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",i[i.OK=200]="OK",i}(F||{}),Ge=(()=>{class i{constructor(t,e){this.router=t,this.toast=e,this.errorPages=[F.FORBIDDEN,F.NOT_FOUND,F.INTERNAL_SERVER_ERROR],this.getMessage=s=>s.error?.message?s.error.message:s.error?.msg?s.error.msg:`${s.status} ${s.statusText}`}intercept(t,e){return e.handle(t).pipe(J(s=>this.handleError(s)))}handleError(t){return this.errorPages.includes(t.status)?this.router.navigateByUrl(`/${t.status}`,{skipLocationChange:!0}):(console.error("ERROR",t),this.toast.error(this.getMessage(t)),t.status===F.UNAUTHORIZED&&this.router.navigateByUrl("/auth/login")),U(t)}static{this.\u0275fac=function(e){return new(e||i)(o(G),o(Dt))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac})}}return i})();var en=[{provide:bt,useClass:$e,multi:!0},{provide:bt,useClass:Je,multi:!0},{provide:bt,useClass:Ge,multi:!0}];var jt=class i{generate(r){return ut({access_token:this.createToken(r,3600),token_type:"bearer",expires_in:r.refresh_token?3600:void 0,refresh_token:r.refresh_token?this.createToken(r,86400):void 0})}getUser(r){let t="";r.body?.refresh_token?t=r.body.refresh_token:r.headers.has("Authorization")&&(t=r.headers.get("Authorization").split(" ")[1]);try{let e=new Date,s=i.parseToken(t);return i.isExpired(s,e)?null:s.user}catch{return null}}createToken(r,t=0){let e=r.refresh_token?V()+t:void 0;return[k.encode(JSON.stringify({typ:"JWT",alg:"HS256"})),k.encode(JSON.stringify(ut(Object.assign({exp:e,user:r})))),k.encode("redstartheme")].join(".")}static parseToken(r){let[,t]=r.split(".");return JSON.parse(k.decode(t))}static isExpired(r,t){let e=new Date;return e.setTime(r.exp*1e3),this.dateToSeconds(e)-this.dateToSeconds(t)<=0}static dateToSeconds(r){return Math.ceil(r.getTime()/1e3)}};var We=new jt,Xe=(()=>{class i{constructor(t,e){this.http=t,this.store=e,this.users=[],this.loadUsers()}loadUsers(){this.http.get("assets/data/users.json?_t="+Date.now()).subscribe(t=>{this.users=t},t=>{console.error("Error loading users:",t)})}login(t,e,s=!1){let n=this.users.find(l=>l.username===t&&l.password===e);if(!n)return p({status:401,body:{}});if(n.password!==e)return p(Object.assign({status:422,error:{errors:{password:["The provided password is incorrect."]}}}));let a=Object.assign({},n);if(delete a.password,n){let l={user:a,token:We.generate(a),status:200};return p(l)}else return p({error:"Invalid credentials"})}refresh(){let t=Object.assign({},this.store.get("currentUser")),e=t?{status:F.OK,body:We.generate(t)}:{status:F.UNAUTHORIZED,body:{}};return p(e)}logout(){return this.store.clear(),p({success:!1})}user(){return this.http.get("/user")}menu(){return this.http.get("assets/data/menu.json?_t="+Date.now()).pipe(tt(t=>t.menu),J(this.handleError))}handleError(t){return console.error("An error occurred:",t),U("Something went wrong; please try again later.")}static{this.\u0275fac=function(e){return new(e||i)(o(_e),o(N))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Be=(()=>{class i{constructor(t,e,s,n){this.loginService=t,this.tokenService=e,this.router=s,this.store=n,this.user$=new L({}),this.change$=fe(this.tokenService.change(),this.tokenService.refresh().pipe(R(()=>this.refresh()))).pipe(R(()=>this.assignUser(this.user$)),A()),this.user$=new L(this.store.get("currentUser"))}init(){return new Promise(t=>this.change$.subscribe(()=>t()))}change(){return this.change$}check(){return this.tokenService.valid()}login(t,e,s=!1){return this.loginService.login(t,e,s).subscribe({next:n=>{let a=JSON.parse(JSON.stringify(n)).token;this.tokenService.set(a);let l=JSON.parse(JSON.stringify(n)).user.role;l.sort((h,w)=>{let E=h.priority,ft=w.priority;return E>ft?1:E<ft?-1:0}),this.tokenService.roleArray=l,this.tokenService.permissionArray=JSON.parse(JSON.stringify(n)).user.permissions,this.user$.next(JSON.parse(JSON.stringify(n)).user),this.store.set("currentUser",n.user);let c=this.tokenService.roleArray.map(h=>h.name),d=JSON.stringify(c);this.store.set("roleNames",d);for(let h of this.tokenService.roleArray??[])if(h.name=="ADMIN"){this.router.navigate(["dashboard/dashboard1"]);break}else if(h.name=="EMPLOYEE"){this.router.navigateByUrl("occupancy");break}else this.router.navigateByUrl("emp_dashboard/dashboard2")},error:n=>{console.error(n)}})}refresh(){return this.loginService.refresh()}logout(){return this.loginService.logout().subscribe(t=>{t.success||(this.tokenService.clear(),this.router.navigateByUrl("/auth/login"))})}user(){return this.user$.pipe(A())}menu(){return he(()=>this.check(),this.loginService.menu(),p([]))}assignUser(t){return this.user$.next(t.getValue()),this.user$.asObservable()}static{this.\u0275fac=function(e){return new(e||i)(o(Xe),o(Ot),o(G),o(N))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{W as a,Q as b,Ki as c,zi as d,Gi as e,N as f,xt as g,Ot as h,Be as i,He as j,Ls as k,Dt as l,Zs as m,en as n};
